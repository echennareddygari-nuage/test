{"zabbix_export": {"date": "2020-02-29T02:04:21Z", "templates": [{"templates": [], "description": "Generic stats for HAProxy servers", "tags": [{"tag": "InUse", "value": "Yes"}, {"tag": "WL", "value": "Yes"}], "items": [{"allow_traps": "0", "snmpv3_contextname": "", "ssl_cert_file": "", "inventory_link": "0", "query_fields": [], "http_proxy": "", "trends": "0", "post_type": "0", "snmpv3_authpassphrase": "", "snmp_oid": "", "snmpv3_securitylevel": "0", "port": "", "ssl_key_file": "", "logtimefmt": "", "jmx_endpoint": "", "master_item": [], "delay": "5m", "publickey": "", "request_method": "0", "params": "", "follow_redirects": "1", "units": "", "verify_host": "0", "type": "0", "snmpv3_authprotocol": "0", "valuemap": [], "ipmi_sensor": "", "username": "", "authtype": "0", "snmp_community": "", "description": "This item collect JSON formatted info about the next PEM file that will expire on the HAproxy system well as how many files fall into each of the three threshold buckets:\r\n\r\nt1 < 30 days\r\nt2 < 15 days\r\nt3 < 5 days", "output_format": "0", "status_codes": "200", "allowed_hosts": "", "snmpv3_securityname": "", "preprocessing": [], "value_type": "4", "key": "cert.expiry", "retrieve_mode": "0", "privatekey": "", "ssl_key_password": "", "password": "", "snmpv3_privpassphrase": "", "snmpv3_privprotocol": "0", "name": "HAProxy cert expiry info", "applications": [{"name": "Expiry"}], "url": "", "posts": "", "headers": [], "status": "0", "timeout": "3s", "verify_peer": "0", "history": "90d"}, {"allow_traps": "0", "snmpv3_contextname": "", "ssl_cert_file": "", "inventory_link": "0", "query_fields": [], "http_proxy": "", "trends": "0", "post_type": "0", "snmpv3_authpassphrase": "", "snmp_oid": "", "snmpv3_securitylevel": "0", "port": "", "ssl_key_file": "", "logtimefmt": "", "jmx_endpoint": "", "master_item": {"key": "cert.expiry"}, "delay": "0", "publickey": "", "request_method": "0", "params": "", "follow_redirects": "1", "units": "", "verify_host": "0", "type": "18", "snmpv3_authprotocol": "0", "valuemap": [], "ipmi_sensor": "", "username": "", "authtype": "0", "snmp_community": "", "description": "Date when  the next PEM cert files expires", "output_format": "0", "status_codes": "200", "allowed_hosts": "", "snmpv3_securityname": "", "preprocessing": [{"error_handler_params": "", "type": "12", "error_handler": "0", "params": "$.nextDate"}], "value_type": "4", "key": "cert.expiry.date", "retrieve_mode": "0", "privatekey": "", "ssl_key_password": "", "password": "", "snmpv3_privpassphrase": "", "snmpv3_privprotocol": "0", "name": "Date when next certificate expires", "applications": [{"name": "Expiry"}], "url": "", "posts": "", "headers": [], "status": "0", "timeout": "3s", "verify_peer": "0", "history": "90d"}, {"allow_traps": "0", "snmpv3_contextname": "", "ssl_cert_file": "", "inventory_link": "0", "query_fields": [], "http_proxy": "", "trends": "365d", "post_type": "0", "snmpv3_authpassphrase": "", "snmp_oid": "", "snmpv3_securitylevel": "0", "port": "", "ssl_key_file": "", "logtimefmt": "", "jmx_endpoint": "", "master_item": {"key": "cert.expiry"}, "delay": "0", "publickey": "", "request_method": "0", "params": "", "follow_redirects": "1", "units": "", "verify_host": "0", "type": "18", "snmpv3_authprotocol": "0", "valuemap": [], "ipmi_sensor": "", "username": "", "authtype": "0", "snmp_community": "", "description": "Days left until the next PEM cert files expires", "output_format": "0", "status_codes": "200", "allowed_hosts": "", "snmpv3_securityname": "", "preprocessing": [{"error_handler_params": "", "type": "12", "error_handler": "0", "params": "$.nextDaysLeft"}], "value_type": "3", "key": "cert.expiry.days", "retrieve_mode": "0", "privatekey": "", "ssl_key_password": "", "password": "", "snmpv3_privpassphrase": "", "snmpv3_privprotocol": "0", "name": "Days left until next certificate expires", "applications": [{"name": "Expiry"}], "url": "", "posts": "", "headers": [], "status": "0", "timeout": "3s", "verify_peer": "0", "history": "90d"}, {"allow_traps": "0", "snmpv3_contextname": "", "ssl_cert_file": "", "inventory_link": "0", "query_fields": [], "http_proxy": "", "trends": "0", "post_type": "0", "snmpv3_authpassphrase": "", "snmp_oid": "", "snmpv3_securitylevel": "0", "port": "", "ssl_key_file": "", "logtimefmt": "", "jmx_endpoint": "", "master_item": {"key": "cert.expiry"}, "delay": "0", "publickey": "", "request_method": "0", "params": "", "follow_redirects": "1", "units": "", "verify_host": "0", "type": "18", "snmpv3_authprotocol": "0", "valuemap": [], "ipmi_sensor": "", "username": "", "authtype": "0", "snmp_community": "", "description": "Days left until the next PEM cert files expires", "output_format": "0", "status_codes": "200", "allowed_hosts": "", "snmpv3_securityname": "", "preprocessing": [{"error_handler_params": "", "type": "12", "error_handler": "0", "params": "$.nextFile"}], "value_type": "4", "key": "cert.expiry.file", "retrieve_mode": "0", "privatekey": "", "ssl_key_password": "", "password": "", "snmpv3_privpassphrase": "", "snmpv3_privprotocol": "0", "name": "Next certificate file to expire", "applications": [{"name": "Expiry"}], "url": "", "posts": "", "headers": [], "status": "0", "timeout": "3s", "verify_peer": "0", "history": "90d"}, {"allow_traps": "0", "snmpv3_contextname": "", "ssl_cert_file": "", "inventory_link": "0", "query_fields": [], "http_proxy": "", "trends": "365d", "post_type": "0", "snmpv3_authpassphrase": "", "snmp_oid": "", "snmpv3_securitylevel": "0", "port": "", "ssl_key_file": "", "logtimefmt": "", "jmx_endpoint": "", "master_item": {"key": "cert.expiry"}, "delay": "0", "publickey": "", "request_method": "0", "params": "", "follow_redirects": "1", "units": "", "verify_host": "0", "type": "18", "snmpv3_authprotocol": "0", "valuemap": [], "ipmi_sensor": "", "username": "", "authtype": "0", "snmp_community": "", "description": "The count of certificate files expiring between 15 and 30 days from now.", "output_format": "0", "status_codes": "200", "allowed_hosts": "", "snmpv3_securityname": "", "preprocessing": [{"error_handler_params": "", "type": "12", "error_handler": "0", "params": "$.t1Count"}], "value_type": "3", "key": "cert.expiry.t1count", "retrieve_mode": "0", "privatekey": "", "ssl_key_password": "", "password": "", "snmpv3_privpassphrase": "", "snmpv3_privprotocol": "0", "name": "Count of certificates expiring in less than 30 days", "applications": [{"name": "Expiry"}], "url": "", "posts": "", "headers": [], "status": "0", "timeout": "3s", "verify_peer": "0", "history": "90d"}, {"allow_traps": "0", "snmpv3_contextname": "", "ssl_cert_file": "", "inventory_link": "0", "query_fields": [], "http_proxy": "", "trends": "0", "post_type": "0", "snmpv3_authpassphrase": "", "snmp_oid": "", "snmpv3_securitylevel": "0", "port": "", "ssl_key_file": "", "logtimefmt": "", "jmx_endpoint": "", "master_item": {"key": "cert.expiry"}, "delay": "0", "publickey": "", "request_method": "0", "params": "", "follow_redirects": "1", "units": "", "verify_host": "0", "type": "18", "snmpv3_authprotocol": "0", "valuemap": [], "ipmi_sensor": "", "username": "", "authtype": "0", "snmp_community": "", "description": "The list of certificate files expiring between 15 and 30 days from now.", "output_format": "0", "status_codes": "200", "allowed_hosts": "", "snmpv3_securityname": "", "preprocessing": [{"error_handler_params": "", "type": "12", "error_handler": "0", "params": "$.t1Files"}], "value_type": "4", "key": "cert.expiry.t1files", "retrieve_mode": "0", "privatekey": "", "ssl_key_password": "", "password": "", "snmpv3_privpassphrase": "", "snmpv3_privprotocol": "0", "name": "List of certificate files expiring in less than 30 days", "applications": [{"name": "Expiry"}], "url": "", "posts": "", "headers": [], "status": "0", "timeout": "3s", "verify_peer": "0", "history": "90d"}, {"allow_traps": "0", "snmpv3_contextname": "", "ssl_cert_file": "", "inventory_link": "0", "query_fields": [], "http_proxy": "", "trends": "365d", "post_type": "0", "snmpv3_authpassphrase": "", "snmp_oid": "", "snmpv3_securitylevel": "0", "port": "", "ssl_key_file": "", "logtimefmt": "", "jmx_endpoint": "", "master_item": {"key": "cert.expiry"}, "delay": "0", "publickey": "", "request_method": "0", "params": "", "follow_redirects": "1", "units": "", "verify_host": "0", "type": "18", "snmpv3_authprotocol": "0", "valuemap": [], "ipmi_sensor": "", "username": "", "authtype": "0", "snmp_community": "", "description": "The count of certificate files expiring between 5 and 15 days from now.", "output_format": "0", "status_codes": "200", "allowed_hosts": "", "snmpv3_securityname": "", "preprocessing": [{"error_handler_params": "", "type": "12", "error_handler": "0", "params": "$.t2Count"}], "value_type": "3", "key": "cert.expiry.t2count", "retrieve_mode": "0", "privatekey": "", "ssl_key_password": "", "password": "", "snmpv3_privpassphrase": "", "snmpv3_privprotocol": "0", "name": "Count of certificates expiring in less than 15 days", "applications": [{"name": "Expiry"}], "url": "", "posts": "", "headers": [], "status": "0", "timeout": "3s", "verify_peer": "0", "history": "90d"}, {"allow_traps": "0", "snmpv3_contextname": "", "ssl_cert_file": "", "inventory_link": "0", "query_fields": [], "http_proxy": "", "trends": "365d", "post_type": "0", "snmpv3_authpassphrase": "", "snmp_oid": "", "snmpv3_securitylevel": "0", "port": "", "ssl_key_file": "", "logtimefmt": "", "jmx_endpoint": "", "master_item": {"key": "cert.expiry"}, "delay": "0", "publickey": "", "request_method": "0", "params": "", "follow_redirects": "1", "units": "", "verify_host": "0", "type": "18", "snmpv3_authprotocol": "0", "valuemap": [], "ipmi_sensor": "", "username": "", "authtype": "0", "snmp_community": "", "description": "The count of certificate files expiring less than 5 days from now.", "output_format": "0", "status_codes": "200", "allowed_hosts": "", "snmpv3_securityname": "", "preprocessing": [{"error_handler_params": "", "type": "12", "error_handler": "0", "params": "$.t3Count"}], "value_type": "3", "key": "cert.expiry.t3count", "retrieve_mode": "0", "privatekey": "", "ssl_key_password": "", "password": "", "snmpv3_privpassphrase": "", "snmpv3_privprotocol": "0", "name": "Count of certificates expiring in less than 5 days", "applications": [{"name": "Expiry"}], "url": "", "posts": "", "headers": [], "status": "0", "timeout": "3s", "verify_peer": "0", "history": "90d"}, {"allow_traps": "0", "snmpv3_contextname": "", "ssl_cert_file": "", "inventory_link": "0", "query_fields": [], "http_proxy": "", "trends": "0", "post_type": "0", "snmpv3_authpassphrase": "", "snmp_oid": "", "snmpv3_securitylevel": "0", "port": "", "ssl_key_file": "", "logtimefmt": "", "jmx_endpoint": "", "master_item": {"key": "cert.expiry"}, "delay": "0", "publickey": "", "request_method": "0", "params": "", "follow_redirects": "1", "units": "", "verify_host": "0", "type": "18", "snmpv3_authprotocol": "0", "valuemap": [], "ipmi_sensor": "", "username": "", "authtype": "0", "snmp_community": "", "description": "The list of certificate files expiring less than 5 days from now.", "output_format": "0", "status_codes": "200", "allowed_hosts": "", "snmpv3_securityname": "", "preprocessing": [{"error_handler_params": "", "type": "12", "error_handler": "0", "params": "$.t3Files"}], "value_type": "4", "key": "cert.expiry.t3files", "retrieve_mode": "0", "privatekey": "", "ssl_key_password": "", "password": "", "snmpv3_privpassphrase": "", "snmpv3_privprotocol": "0", "name": "List of certificate files expiring in less than 5 days", "applications": [{"name": "Expiry"}], "url": "", "posts": "", "headers": [], "status": "0", "timeout": "3s", "verify_peer": "0", "history": "90d"}, {"allow_traps": "0", "snmpv3_contextname": "", "ssl_cert_file": "", "inventory_link": "0", "query_fields": [], "http_proxy": "", "trends": "365d", "post_type": "0", "snmpv3_authpassphrase": "", "snmp_oid": "", "snmpv3_securitylevel": "0", "port": "", "ssl_key_file": "", "logtimefmt": "", "jmx_endpoint": "", "master_item": [], "delay": "30s", "publickey": "", "request_method": "0", "params": "", "follow_redirects": "1", "units": "", "verify_host": "0", "type": "0", "snmpv3_authprotocol": "0", "valuemap": [], "ipmi_sensor": "", "username": "", "authtype": "0", "snmp_community": "", "description": "0 -> OK: Actual state matches reported state\r\n2 -> INCONSISTENT: Actual state and reported state are inconsistent", "output_format": "0", "status_codes": "200", "allowed_hosts": "", "snmpv3_securityname": "", "preprocessing": [], "value_type": "3", "key": "haproxy.master.actualstate", "retrieve_mode": "0", "privatekey": "", "ssl_key_password": "", "password": "", "snmpv3_privpassphrase": "", "snmpv3_privprotocol": "0", "name": "HAProxy master actual state", "applications": [{"name": "Haproxy"}], "url": "", "posts": "", "headers": [], "status": "0", "timeout": "3s", "verify_peer": "0", "history": "90d"}, {"allow_traps": "0", "snmpv3_contextname": "", "ssl_cert_file": "", "inventory_link": "0", "query_fields": [], "http_proxy": "", "trends": "0", "post_type": "0", "snmpv3_authpassphrase": "", "snmp_oid": "", "snmpv3_securitylevel": "0", "port": "", "ssl_key_file": "", "logtimefmt": "", "jmx_endpoint": "", "master_item": [], "delay": "0", "publickey": "", "request_method": "0", "params": "", "follow_redirects": "1", "units": "", "verify_host": "0", "type": "2", "snmpv3_authprotocol": "0", "valuemap": [], "ipmi_sensor": "", "username": "", "authtype": "0", "snmp_community": "", "description": "", "output_format": "0", "status_codes": "200", "allowed_hosts": "", "snmpv3_securityname": "", "preprocessing": [], "value_type": "4", "key": "haproxy.master.failover", "retrieve_mode": "0", "privatekey": "", "ssl_key_password": "", "password": "", "snmpv3_privpassphrase": "", "snmpv3_privprotocol": "0", "name": "HAproxy master failover status string", "applications": [{"name": "Haproxy"}], "url": "", "posts": "", "headers": [], "status": "0", "timeout": "3s", "verify_peer": "0", "history": "90d"}, {"allow_traps": "0", "snmpv3_contextname": "", "ssl_cert_file": "", "inventory_link": "0", "query_fields": [], "http_proxy": "", "trends": "365d", "post_type": "0", "snmpv3_authpassphrase": "", "snmp_oid": "", "snmpv3_securitylevel": "0", "port": "", "ssl_key_file": "", "logtimefmt": "", "jmx_endpoint": "", "master_item": [], "delay": "30s", "publickey": "", "request_method": "0", "params": "", "follow_redirects": "1", "units": "", "verify_host": "0", "type": "0", "snmpv3_authprotocol": "0", "valuemap": [], "ipmi_sensor": "", "username": "", "authtype": "0", "snmp_community": "", "description": "The current state of the haproxy according to keepalived:\r\n\r\n2 - fault\r\n0 - master\r\n1 - backup\r\n3 - unknown/anything else", "output_format": "0", "status_codes": "200", "allowed_hosts": "", "snmpv3_securityname": "", "preprocessing": [{"error_handler_params": "", "type": "5", "error_handler": "0", "params": "(.*)\n\\1:MASTER=0:BACKUP=1:FAULT=2"}, {"error_handler_params": "3", "type": "5", "error_handler": "3", "params": "(MASTER|BACKUP|FAULT)(?=.*:\\1=(\\d))\n\\2"}], "value_type": "3", "key": "haproxy.master.state", "retrieve_mode": "0", "privatekey": "", "ssl_key_password": "", "password": "", "snmpv3_privpassphrase": "", "snmpv3_privprotocol": "0", "name": "HAProxy master current state", "applications": [{"name": "Haproxy"}], "url": "", "posts": "", "headers": [], "status": "0", "timeout": "3s", "verify_peer": "0", "history": "90d"}], "httptests": [], "screens": [], "applications": [{"name": "Expiry"}, {"name": "Haproxy"}, {"name": "Zabbix agent"}, {"name": "Zabbix trapper"}], "discovery_rules": [], "groups": [{"name": "Haproxy nodes"}], "template": "Template App HAProxy server", "macros": [], "name": "Template App HAProxy server"}], "version": "4.2", "groups": [{"name": "Haproxy nodes"}], "triggers": [{"status": "0", "recovery_mode": "0", "description": "The next certificate file to expire on this server will happen less than 5 days from now.\r\n\r\nService affecting...fix as soon as possible.", "tags": [], "url": "", "type": "0", "priority": "5", "correlation_tag": "", "dependencies": [], "correlation_mode": "0", "manual_close": "1", "expression": "{Template App HAProxy server:cert.expiry.days.last()}<=5", "recovery_expression": "", "name": "Certificate expiry in less than 5 days"}, {"status": "0", "recovery_mode": "0", "description": "The next certificate file to expire on this server will happen between 5 and 15 days from now.\r\n\r\nService affecting...fix as soon as possible.", "tags": [], "url": "", "type": "0", "priority": "4", "correlation_tag": "", "dependencies": [], "correlation_mode": "0", "manual_close": "1", "expression": "{Template App HAProxy server:cert.expiry.days.last()}<=15 and {Template App HAProxy server:cert.expiry.days.last()}>5", "recovery_expression": "", "name": "Certificate expiry in less than 15 days"}, {"status": "0", "recovery_mode": "0", "description": "The next certificate file to expire on this server will happen between 15 and 30 days from now.\r\n\r\nService affecting...fix as soon as possible.", "tags": [], "url": "", "type": "0", "priority": "3", "correlation_tag": "", "dependencies": [], "correlation_mode": "0", "manual_close": "1", "expression": "{Template App HAProxy server:cert.expiry.days.last()}<=30 and {Template App HAProxy server:cert.expiry.days.last()}>15", "recovery_expression": "", "name": "Certificate expiry in less than 30 days"}, {"status": "0", "recovery_mode": "0", "description": "This node has detected a change in the haproxy master/standby status. This event is NOT self clearing...you must acknowledge the alarm.", "tags": [], "url": "", "type": "0", "priority": "4", "correlation_tag": "", "dependencies": [], "correlation_mode": "0", "manual_close": "1", "expression": "{Template App HAProxy server:haproxy.master.failover.diff()}=1", "recovery_expression": "", "name": "HAproxy master/standby state has changed. Current state: {ITEM.LASTVALUE1}"}, {"status": "0", "recovery_mode": "0", "description": "", "tags": [], "url": "", "type": "0", "priority": "4", "correlation_tag": "", "dependencies": [], "correlation_mode": "0", "manual_close": "0", "expression": "{Template App HAProxy server:haproxy.master.actualstate.last()}<>0", "recovery_expression": "", "name": "HAproxy reported state versus actual state is inconsistent"}]}}